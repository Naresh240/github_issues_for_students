aws logs filter-log-events --log-group-name "/ucc/eks/dm-campaign-process-manager/dev" --filter-pattern "INFO" --limit 20

aws logs put-metric-filter --log-group-name "/ucc/eks/dm-campaign-process-manager/dev" --filter-name "InfoLogFilter" --filter-pattern "INFO" --metric-transformations "metricName=InfoLogCount,metricNamespace=UccDmApp,metricValue=1"

aws logs describe-metric-filters --log-group-name "/ucc/eks/dm-campaign-process-manager/dev"

aws cloudwatch put-metric-alarm --alarm-name "InfoLogAlarm" --alarm-description "Alarm when INFO logs appear in dm-campaign-process-manager" --metric-name "InfoLogCount" --namespace "UccDmApp" --statistic Sum --period 60 --threshold 0 --comparison-operator GreaterThanThreshold --evaluation-periods 1 --treat-missing-data notBreaching --alarm-actions test-sns-topic

    url = f"https://<cluster-url>/k8s-utils/v1/pods/{namespace}/{pod_name}"

    headers = {
        "Authorization": f"Bearer {API_TOKEN}",
        "Content-Type": "application/json"
    }

    req = urllib.request.Request(url, headers=headers, method="DELETE")

    try:
        with urllib.request.urlopen(req) as response:
            response_data = response.read().decode("utf-8")
            status_code = response.getcode()
            print(f"✅ Pod delete request sent. status={status_code}, response={response_data}")

            # Wait for deletion to actually happen
            time.sleep(10)
            return True

    except urllib.error.HTTPError as e:
        error_body = e.read().decode("utf-8")
        if e.code == 404:
            print(f"ℹ️ Pod {pod_name} in ns {namespace} not found (already deleted).")
            return False
        else:
            print(f"❌ HTTPError: status={e.code}, body={error_body}")
            return False

    except urllib.error.URLError as e:
        print(f"❌ URLError: reason={e.reason}")
        return False
